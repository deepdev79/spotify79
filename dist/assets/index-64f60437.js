(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const v of s.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&i(v)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();let m=10;const T=document.querySelector(".album-data"),te=document.querySelectorAll(".album-button");function g(){let e,t,n,i;for(let a=m-10;a<m;a++){if(a>=d.length)return;t=document.createElement("tr");for(let s=0;s<4;s++)n=document.createElement("td"),s===0?i=document.createTextNode(`${a+1}.${d[a].get("name")}`):s===1?i=document.createTextNode(`${d[a].get("aname")}`):s===2?i=document.createTextNode(`${d[a].get("timesPlayed")}`):(e=(d[a].get("mins")/6e4/60).toFixed(2),i=document.createTextNode(`${e}`)),n.appendChild(i),t.appendChild(n);T.appendChild(t)}}function b(){for(;T.childNodes.length;)T.removeChild(T.childNodes[0])}function ne(){te.forEach(e=>e.addEventListener("click",function(t){let n;if(n=t.target.innerText,n==="Next"){if(d.length-(m+10)<=-10)return;m=m+10,b(),g()}else{if(m===10)return;b(),m=m-10,g()}}))}ne();const M=document.querySelector(".sort-album");M.addEventListener("click",ie);function ie(e){e.target.innerText==="Sort by Minutes"?(M.textContent="Sort by Times Listened",d.sort((t,n)=>n.get("mins")-t.get("mins")),b(),m=10,g()):(M.textContent="Sort by Minutes",d.sort((t,n)=>n.get("timesPlayed")-t.get("timesPlayed")),b(),m=10,g())}let u=10;const C=document.querySelector(".artist-data"),ae=document.querySelectorAll(".artist-button");function y(){let e,t,n,i;for(let a=u-10;a<u;a++){if(a>=r.length)return;t=document.createElement("tr");for(let s=0;s<4;s++)n=document.createElement("td"),s===0?i=document.createTextNode(`${a+1}.${r[a].get("name")}`):s===1?i=document.createTextNode(`${r[a].get("timesPlayed")}`):s===2?(e=(r[a].get("mins")/6e4).toFixed(2),i=document.createTextNode(`${e}`)):i=document.createTextNode(`${(e/60).toFixed(2)}`),n.appendChild(i),t.appendChild(n);C.appendChild(t)}}function x(){for(;C.childNodes.length;)C.removeChild(C.childNodes[0])}function se(){ae.forEach(e=>e.addEventListener("click",function(t){let n;if(n=t.target.innerText,n==="Next"){if(r.length-(u+10)<=-10)return;u=u+10,x(),y()}else{if(u===10)return;x(),u=u-10,y()}}))}se();const A=document.querySelector(".sort-artist");A.addEventListener("click",le);function le(e){e.target.innerText==="Sort by Minutes"?(A.textContent="Sort by Times Listened",r.sort((t,n)=>n.get("mins")-t.get("mins")),x(),u=10,y()):(A.textContent="Sort by Minutes",r.sort((t,n)=>n.get("timesPlayed")-t.get("timesPlayed")),x(),u=10,y())}let f=10;const E=document.querySelector(".track-data"),oe=document.querySelectorAll(".track-button");function p(){let e,t,n,i;for(let a=f-10;a<f;a++){if(a>=l.length)return;t=document.createElement("tr");for(let s=0;s<4;s++)n=document.createElement("td"),s===0?i=document.createTextNode(`${a+1}.${l[a].get("name")}`):s===1?i=document.createTextNode(`${l[a].get("aname")}`):s===2?i=document.createTextNode(`${l[a].get("timesPlayed")}`):(e=(l[a].get("mins")/6e4/60).toFixed(2),i=document.createTextNode(`${e}`)),n.appendChild(i),t.appendChild(n);E.appendChild(t)}}function P(){for(;E.childNodes.length;)E.removeChild(E.childNodes[0])}function re(){oe.forEach(e=>e.addEventListener("click",function(t){let n;if(n=t.target.innerText,n==="Next"){if(l.length-(f+10)<=-10)return;f=f+10,P(),p()}else{if(f===10)return;P(),f=f-10,p()}}))}re();const I=document.querySelector(".sort-track");I.addEventListener("click",de);function de(e){e.target.innerText==="Sort by Minutes"?(I.textContent="Sort by Times Listened",l.sort((t,n)=>n.get("mins")-t.get("mins")),P(),f=10,p()):(I.textContent="Sort by Minutes",l.sort((t,n)=>n.get("timesPlayed")-t.get("timesPlayed")),P(),f=10,p())}const N=document.querySelector(".platform"),S=document.querySelector(".countries");function ce(){for(;N.childNodes.length>2;)N.removeChild(N.childNodes[0]);for(;S.childNodes.length>2;)S.removeChild(S.childNodes[0])}function me(){let e;G.forEach(t=>{e=document.createElement("li"),e.textContent=t,N.appendChild(e)})}function ue(){let e;Q.forEach(t=>{e=document.createElement("li"),e.textContent=t,S.appendChild(e)})}const L=document.createElement("p"),w=document.createElement("p"),k=document.createElement("p"),h=document.querySelector(".data-result");let D,q,R;function Y(){D=($/6e4).toFixed(2),q=(D/60).toFixed(2),R=(q/24).toFixed(2),L.textContent=`This data is only valid from ${W} to ${X}`,L.classList.add("data-result"),h.appendChild(L),w.textContent=`You have listened to music for ${D} mins or ${q} hours or ${R} days`,w.classList.add("data-result"),h.appendChild(w)}function fe(){k.textContent="Dates selected seem to be out of range in relative to data input",k.classList.add("data-result"),h.appendChild(k)}const U=document.createElement("p");function he(){U.textContent="No file selected to upload",h.appendChild(U)}function V(){for(;h.childNodes.length;)h.removeChild(h.childNodes[0])}const ye=document.querySelectorAll("a");let H,pe=["Home","Album","Track","Other","Artist"];function ge(e){H=document.getElementById(`${e}`),H.classList.remove("hidden"),pe.forEach(t=>{t!=e&&document.getElementById(`${t}`).classList.add("hidden")})}function be(){ye.forEach(e=>{e.addEventListener("click",function(t){ge(t.target.innerText)})})}const z=document.querySelector(".loader");let c=[],d=[],r=[],l=[],G,Q,F=[],B=[],O=[],o,j=0,$=0,W,X;function J(e,t){W=new Date(e).toUTCString(),X=new Date(t).toUTCString()}function xe(){c.forEach(e=>{$+=e.ms_played,F.push(e.platform),B.push(e.conn_country)}),G=new Set(F),Q=new Set(B)}function Pe(e){o=1;let t=new Map;r.forEach(n=>{n.get("name")===e.master_metadata_album_artist_name&&(o=0,n.set("mins",n.get("mins")+e.ms_played),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.master_metadata_album_artist_name),t.set("mins",e.ms_played),t.set("timesPlayed",1),r.push(t))}function Te(e){o=1;let t=new Map;l.forEach(n=>{n.get("url")===e.spotify_track_uri&&(o=0,n.set("mins",n.get("mins")+e.ms_played),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.master_metadata_track_name),t.set("aname",e.master_metadata_album_artist_name),t.set("mins",e.ms_played),t.set("timesPlayed",1),t.set("url",e.spotify_track_uri),l.push(t))}function Ce(e){o=1;let t=new Map;d.forEach(n=>{n.get("name")===e.master_metadata_album_album_name&&(o=0,n.set("mins",n.get("mins")+e.ms_played),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.master_metadata_album_album_name),t.set("aname",e.master_metadata_album_artist_name),t.set("mins",e.ms_played),t.set("timesPlayed",1),d.push(t))}function Ee(){for(const e of c)Pe(e),Te(e),Ce(e);r.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed")),l.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed")),d.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed"))}function Ne(e){o=1;let t=new Map;r.forEach(n=>{n.get("name")===e.artistName&&(o=0,n.set("mins",n.get("mins")+e.msPlayed),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.artistName),t.set("mins",e.msPlayed),t.set("timesPlayed",1),r.push(t))}function Se(e){o=1,$+=e.msPlayed;let t=new Map;l.forEach(n=>{n.get("name")===e.trackName&&(o=0,n.set("mins",n.get("mins")+e.msPlayed),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.trackName),t.set("aname",e.artistName),t.set("mins",e.msPlayed),t.set("timesPlayed",1),l.push(t))}function _e(){for(const e of c)Ne(e),Se(e);r.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed")),l.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed"))}function Z(e){Me(),c=e.flat(),Object.keys(c[0]).length<5?(_e(),J(c[0].endTime,c.slice(-1)[0].endTime),y(),p(),Y()):(xe(),Ee(),J(c[0].ts,c.slice(-1)[0].ts),g(),me(),ue(),y(),p(),Y()),z.classList.add("hidden-loader")}function $e(e,t){let n=[];j===0&&(O=c,j=1),n=O.filter(i=>new Date(i.ts?i.ts:i.endTime).getTime()>=e.getTime()&&new Date(i.ts?i.ts:i.endTime).getTime()<=t.getTime()),n.length===0?(V(),fe()):Z(n)}const K=document.createElement("p");let ve=document.querySelector("#upload"),ee=document.querySelector('input[type="file"]');const Le=document.querySelector(".file-info"),_=document.querySelector(".file-list");function we(){for(;_.childNodes.length;)_.removeChild(_.childNodes[0])}function ke(e){we();let t=e.target.files;K.textContent="Click upload to use the above file(s)",Le.appendChild(K);for(let n=0;n<t.length;n++){let i=document.createElement("li");i.textContent=`File ${n+1} = ${t[n].name}`,_.appendChild(i)}}function De(e){e.preventDefault();let t=ee.files;if(t.length===0){he();return}z.classList.remove("hidden-loader"),O=[],j=0,Ie.classList.remove("hidden");let n=[];for(let i=0;i<t.length;i++)n.push(qe(t[i]));Promise.all(n).then(i=>{Z(i)})}function qe(e){return new Promise(function(t,n){let i=new FileReader;i.onload=function(){t(JSON.parse(i.result))},i.onerror=function(){n(i)},i.readAsText(e)})}function Me(){c=[],r=[],l=[],d=[],B=[],F=[],$=0,V(),b(),x(),P(),ce()}ee.addEventListener("change",ke);ve.addEventListener("submit",De);let Ae=document.querySelector("#filter-date"),Ie=document.querySelector(".date-m");const Fe=document.getElementById("start"),Be=document.getElementById("end");function Oe(e){e.preventDefault();let t=new Date(Fe.value),n=new Date(Be.value);$e(t,n)}Ae.addEventListener("submit",Oe);be();
