(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const v of a.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();let m=10;const E=document.querySelector(".album-data"),Q=document.querySelectorAll(".album-button");function g(){let e,t,n,s;for(let i=m-10;i<m;i++){if(i>=d.length)return;t=document.createElement("tr");for(let a=0;a<4;a++)n=document.createElement("td"),a===0?s=document.createTextNode(`${i+1}.${d[i].get("name")}`):a===1?s=document.createTextNode(`${d[i].get("aname")}`):a===2?s=document.createTextNode(`${d[i].get("timesPlayed")}`):(e=(d[i].get("mins")/6e4/60).toFixed(2),s=document.createTextNode(`${e}`)),n.appendChild(s),t.appendChild(n);E.appendChild(t)}}function x(){for(;E.childNodes.length;)E.removeChild(E.childNodes[0])}function W(){Q.forEach(e=>e.addEventListener("click",function(t){let n;if(n=t.target.innerText,n==="Next"){if(d.length-(m+10)<=-10)return;m=m+10,x(),g()}else{if(m===10)return;x(),m=m-10,g()}}))}W();const w=document.querySelector(".sort-album");w.addEventListener("click",X);function X(e){e.target.innerText==="Sort by Minutes"?(w.textContent="Sort by Times Listened",d.sort((t,n)=>n.get("mins")-t.get("mins")),x(),m=10,g()):(w.textContent="Sort by Minutes",d.sort((t,n)=>n.get("timesPlayed")-t.get("timesPlayed")),x(),m=10,g())}let u=10;const N=document.querySelector(".artist-data"),Z=document.querySelectorAll(".artist-button");function y(){let e,t,n,s;for(let i=u-10;i<u;i++){if(i>=r.length)return;t=document.createElement("tr");for(let a=0;a<4;a++)n=document.createElement("td"),a===0?s=document.createTextNode(`${i+1}.${r[i].get("name")}`):a===1?s=document.createTextNode(`${r[i].get("timesPlayed")}`):a===2?(e=(r[i].get("mins")/6e4).toFixed(2),s=document.createTextNode(`${e}`)):s=document.createTextNode(`${(e/60).toFixed(2)}`),n.appendChild(s),t.appendChild(n);N.appendChild(t)}}function b(){for(;N.childNodes.length;)N.removeChild(N.childNodes[0])}function ee(){Z.forEach(e=>e.addEventListener("click",function(t){let n;if(n=t.target.innerText,n==="Next"){if(r.length-(u+10)<=-10)return;u=u+10,b(),y()}else{if(u===10)return;b(),u=u-10,y()}}))}ee();const M=document.querySelector(".sort-artist");M.addEventListener("click",te);function te(e){e.target.innerText==="Sort by Minutes"?(M.textContent="Sort by Times Listened",r.sort((t,n)=>n.get("mins")-t.get("mins")),b(),u=10,y()):(M.textContent="Sort by Minutes",r.sort((t,n)=>n.get("timesPlayed")-t.get("timesPlayed")),b(),u=10,y())}let f=10;const T=document.querySelector(".track-data"),ne=document.querySelectorAll(".track-button");function p(){let e,t,n,s;for(let i=f-10;i<f;i++){if(i>=l.length)return;t=document.createElement("tr");for(let a=0;a<4;a++)n=document.createElement("td"),a===0?s=document.createTextNode(`${i+1}.${l[i].get("name")}`):a===1?s=document.createTextNode(`${l[i].get("aname")}`):a===2?s=document.createTextNode(`${l[i].get("timesPlayed")}`):(e=(l[i].get("mins")/6e4/60).toFixed(2),s=document.createTextNode(`${e}`)),n.appendChild(s),t.appendChild(n);T.appendChild(t)}}function P(){for(;T.childNodes.length;)T.removeChild(T.childNodes[0])}function ie(){ne.forEach(e=>e.addEventListener("click",function(t){let n;if(n=t.target.innerText,n==="Next"){if(l.length-(f+10)<=-10)return;f=f+10,P(),p()}else{if(f===10)return;P(),f=f-10,p()}}))}ie();const A=document.querySelector(".sort-track");A.addEventListener("click",se);function se(e){e.target.innerText==="Sort by Minutes"?(A.textContent="Sort by Times Listened",l.sort((t,n)=>n.get("mins")-t.get("mins")),P(),f=10,p()):(A.textContent="Sort by Minutes",l.sort((t,n)=>n.get("timesPlayed")-t.get("timesPlayed")),P(),f=10,p())}const _=document.querySelector(".platform"),S=document.querySelector(".countries");function ae(){for(;_.childNodes.length>2;)_.removeChild(_.childNodes[0]);for(;S.childNodes.length>2;)S.removeChild(S.childNodes[0])}function le(){let e;J.forEach(t=>{e=document.createElement("li"),e.textContent=t,_.appendChild(e)})}function oe(){let e;K.forEach(t=>{e=document.createElement("li"),e.textContent=t,S.appendChild(e)})}const C=document.createElement("p"),D=document.createElement("p"),h=document.querySelector(".data-result");let k,q,O;function B(){k=(L/6e4).toFixed(2),q=(k/60).toFixed(2),O=(q/24).toFixed(2),C.textContent=`This data is only valid from ${V} to ${z}`,C.classList.add("data-result"),h.appendChild(C),D.textContent=`You have listened to music for ${k} mins or ${q} hours or ${O} days`,C.classList.add("data-result"),h.appendChild(D)}const j=document.createElement("p");function re(){j.textContent="No file selected to upload",h.appendChild(j)}function de(){for(;h.childNodes.length;)h.removeChild(h.childNodes[0])}const ce=document.querySelectorAll("a");let R,me=["Home","Album","Track","Other","Artist"];function ue(e){R=document.getElementById(`${e}`),R.classList.remove("hidden"),me.forEach(t=>{t!=e&&document.getElementById(`${t}`).classList.add("hidden")})}function fe(){ce.forEach(e=>{e.addEventListener("click",function(t){ue(t.target.innerText)})})}const H=document.querySelector(".loader");let c=[],d=[],r=[],l=[],J,K,F=[],I=[],o,L=0,V,z;function Y(e,t){V=new Date(e).toUTCString(),z=new Date(t).toUTCString()}function he(){c.forEach(e=>{L+=e.ms_played,F.push(e.platform),I.push(e.conn_country)}),J=new Set(F),K=new Set(I)}function ye(e){o=1;let t=new Map;r.forEach(n=>{n.get("name")===e.master_metadata_album_artist_name&&(o=0,n.set("mins",n.get("mins")+e.ms_played),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.master_metadata_album_artist_name),t.set("mins",e.ms_played),t.set("timesPlayed",1),r.push(t))}function pe(e){o=1;let t=new Map;l.forEach(n=>{n.get("url")===e.spotify_track_uri&&(o=0,n.set("mins",n.get("mins")+e.ms_played),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.master_metadata_track_name),t.set("aname",e.master_metadata_album_artist_name),t.set("mins",e.ms_played),t.set("timesPlayed",1),t.set("url",e.spotify_track_uri),l.push(t))}function ge(e){o=1;let t=new Map;d.forEach(n=>{n.get("name")===e.master_metadata_album_album_name&&(o=0,n.set("mins",n.get("mins")+e.ms_played),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.master_metadata_album_album_name),t.set("aname",e.master_metadata_album_artist_name),t.set("mins",e.ms_played),t.set("timesPlayed",1),d.push(t))}function xe(){for(const e of c)ye(e),pe(e),ge(e);r.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed")),l.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed")),d.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed"))}function be(e){o=1;let t=new Map;r.forEach(n=>{n.get("name")===e.artistName&&(o=0,n.set("mins",n.get("mins")+e.msPlayed),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.artistName),t.set("mins",e.msPlayed),t.set("timesPlayed",1),r.push(t))}function Pe(e){o=1,L+=e.msPlayed;let t=new Map;l.forEach(n=>{n.get("name")===e.trackName&&(o=0,n.set("mins",n.get("mins")+e.msPlayed),n.set("timesPlayed",n.get("timesPlayed")+1))}),o===1&&(t.set("name",e.trackName),t.set("aname",e.artistName),t.set("mins",e.msPlayed),t.set("timesPlayed",1),l.push(t))}function Ce(){for(const e of c)be(e),Pe(e);r.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed")),l.sort((e,t)=>t.get("timesPlayed")-e.get("timesPlayed"))}function Ee(e){c.length>0&&(c=[],r=[],l=[],d=[],I=[],F=[],L=0),c=e.flat(),Object.keys(c[0]).length<5?(Ce(),Y(c[0].endTime,c.slice(-1)[0].endTime),y(),p(),B()):(he(),xe(),Y(c[0].ts,c.slice(-1)[0].ts),g(),le(),oe(),y(),p(),B()),H.classList.add("hidden-loader")}const U=document.createElement("p");let Ne=document.querySelector("#upload"),G=document.querySelector('input[type="file"]');const Te=document.querySelector(".file-info"),$=document.querySelector(".file-list");function _e(){for(;$.childNodes.length;)$.removeChild($.childNodes[0])}function Se(e){_e();let t=e.target.files;U.textContent="Click upload to use the above file(s)",Te.appendChild(U);for(let n=0;n<t.length;n++){let s=document.createElement("li");s.textContent=`File ${n+1} = ${t[n].name}`,$.appendChild(s)}}function $e(e){e.preventDefault();let t=G.files;if(t.length===0){re();return}H.classList.remove("hidden-loader"),de(),x(),b(),P(),ae();let n=[];for(let s=0;s<t.length;s++)n.push(Le(t[s]));Promise.all(n).then(s=>{Ee(s)})}function Le(e){return new Promise(function(t,n){let s=new FileReader;s.onload=function(){t(JSON.parse(s.result))},s.onerror=function(){n(s)},s.readAsText(e)})}G.addEventListener("change",Se);Ne.addEventListener("submit",$e);fe();
